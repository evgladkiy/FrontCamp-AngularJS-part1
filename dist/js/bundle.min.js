"use strict";function TodosService(o,t){function e(){return r||n?t.resolve(r):o.get("./initData/todos.json").then(function(o){return r=o.data})}var r=null,n=!1;return{getTodos:e,addTodo:function(o){var t=Object.assign(o,{creationDate:new Date,_id:String(function(o,t){return Math.floor(Math.random()*(o-t+1))+t}(0,1e7))});r?r.unshift(t):e.then(function(){return r.unshift(t)})},removeTodo:function(o){var t=r.findIndex(function(t){return t._id===o});r.splice(t,1)},updateTodo:function(o){var t=r.findIndex(function(t){return t._id===o._id});r.splice(t,1,o)}}}function AddTodoCtrl(o,t,e,r){o.newTodo={assignee:"",todoText:"",duration:""},o.shouldShowErrors=r.shouldShowErrors,o.addTodo=function(r){o.newTodoForm.$valid&&(e.addTodo(r),t.go("home"))}}function EditTodoCtrl(o,t,e,r,n){o.todoCopy=Object.assign({},n),o.shouldShowErrors=r.shouldShowErrors,o.updateTodo=function(){o.updateTodoForm.$valid&&(e.updateTodo(o.todoCopy),t.go("home"))}}function todosFilter(o,t){return function(e){return e.filter(function(o){switch(t.getDoneFilter()){case"done":return o.isDone;case"inProgress":return!o.isDone;default:return o}}).filter(function(e){var r=t.getFilterValue(),n=t.getCategoryFilter(),d=void 0;return"todo"===n?d=e.todoText.toLowerCase():"date"===n&&(d=o("date")(e.creationDate,"dd.MM")),0===d.indexOf(r)})}}function TodosToolboxService(){var o="",t="todo",e="all";return{getFilterValue:function(){return o.trim().toLowerCase()},setFilterValue:function(t){o=t},getCategoryFilter:function(){return t},setCategoryFilter:function(o){t=o},getDoneFilter:function(){return e},setDoneFilter:function(o){e=o}}}angular.module("app",["ui.router","ngMessages"]),angular.module("app").factory("InputErrorsService",function(){return{shouldShowErrors:function(o,t){return o.$dirty&&o.$touched||t}}}),angular.module("app").factory("TodosService",["$http","$q",TodosService]),angular.module("app").config(["$stateProvider",function(o){o.state("addTodo",{url:"/add-todo",templateUrl:"./pages/addTodo/templates/addTodo.html",controller:"AddTodoCtrl"})}]),angular.module("app").config(["$stateProvider",function(o){o.state("editTodo",{url:"/edit-todo/:id",templateUrl:"./pages/editTodo/templates/editTodo.html",controller:"EditTodoCtrl",resolve:{todo:function(o,t){return t.getTodos().then(function(t){return t.find(function(t){return t._id===o.id})})}},onEnter:function(o,t){void 0===t&&o.go("home")}})}]),angular.module("app").config(["$stateProvider","$urlRouterProvider",function(o,t){o.state("home",{url:"/home",templateUrl:"./pages/home/templates/home.html",controller:"HomeCtrl",resolve:{todos:function(o){return o.getTodos()}}}),t.otherwise("/home")}]),angular.module("app").controller("AddTodoCtrl",["$scope","$state","TodosService","InputErrorsService",AddTodoCtrl]),angular.module("app").controller("EditTodoCtrl",["$scope","$state","TodosService","InputErrorsService","todo",EditTodoCtrl]),angular.module("app").controller("HomeCtrl",["$scope","todos",function(o,t){o.todos=t}]),angular.module("app").filter("capitalize",function(){return function(o){return o.charAt(0).toUpperCase()+o.slice(1)}}),angular.module("app").filter("dateToPastDaysFilter",function(){return function(o){var t=Date.now()-new Date(o),e=Math.floor(t/864e5);return e>0?e:.5}}),angular.module("app").filter("todosFilter",["$filter","TodosToolboxService",todosFilter]),angular.module("app").factory("TodosToolboxService",TodosToolboxService),angular.module("app").directive("todo",[function(){return{restrict:"E",scope:{todo:"="},templateUrl:"./pages/home/directives/todo/todo.html",controller:"TodoCtrl"}}]),angular.module("app").controller("TodoCtrl",["$scope","TodosService",function(o,t){o.removeTodo=function(o){return t.removeTodo(o)}}]),angular.module("app").directive("todoList",[function(){return{restrict:"E",scope:{todos:"="},templateUrl:"./pages/home/directives/todoList/todoList.html"}}]),angular.module("app").directive("todosToolbox",function(){return{restrict:"E",templateUrl:"./pages/home/directives/todosToolbox/todosToolbox.html",controller:"TodosToolboxCtrl"}}),angular.module("app").controller("TodosToolboxCtrl",["$scope","TodosToolboxService",function(o,t){o.filterValue=t.getFilterValue(),o.categoryFilter=t.getCategoryFilter(),o.doneFilter=t.getDoneFilter(),o.updateFilterValue=function(){return t.setFilterValue(o.filterValue)},o.updateCategoryFilter=function(){return t.setCategoryFilter(o.categoryFilter)},o.updateDoneFilter=function(){return t.setDoneFilter(o.doneFilter)}}]);