"use strict";var app=angular.module("app",["ui.router","ngMessages","ngResource"]);function TodosService(o,e){var n=null,t=!1;function d(){return n||t?o.resolve(n):e.getTodos().$promise.then(function(o){return t=!0,n=o})}return{getTodos:d,addTodo:function(o){var e,t,r=Object.assign(o,{creationDate:new Date,_id:String((e=0,t=1e7,Math.floor(Math.random()*(e-t+1))+t))});n?n.unshift(r):d.then(function(){return n.unshift(r)})},removeTodo:function(e){var o=n.findIndex(function(o){return o._id===e});n.splice(o,1)},updateTodo:function(e){var o=n.findIndex(function(o){return o._id===e._id});n.splice(o,1,e)}}}function EditTodoCtrl(o,e,t,r,n){o.todoCopy=Object.assign({},n),o.shouldShowErrors=r.shouldShowErrors,o.updateTodo=function(){o.updateTodoForm.$valid&&(t.updateTodo(o.todoCopy),e.go("home"))}}function todosFilter(n,d){return function(o){return o.filter(function(o){switch(d.getDoneFilter()){case"done":return o.isDone;case"inProgress":return!o.isDone;default:return o}}).filter(function(o){var e=d.getFilterValue(),t=d.getCategoryFilter(),r=void 0;return"todo"===t?r=o.todoText.toLowerCase():"date"===t&&(r=n("date")(o.creationDate,"dd.MM")),0===r.indexOf(e)})}}function TodosToolboxService(){var e="",t="todo",r="all";return{getFilterValue:function(){return e.trim().toLowerCase()},setFilterValue:function(o){e=o},getCategoryFilter:function(){return t},setCategoryFilter:function(o){t=o},getDoneFilter:function(){return r},setDoneFilter:function(o){r=o}}}function AddTodoCtrl(e,t,r,o){e.newTodo={assignee:"",todoText:"",duration:""},e.shouldShowErrors=o.shouldShowErrors,e.addTodo=function(o){e.newTodoForm.$valid&&(r.addTodo(o),t.go("home"))}}angular.module("app").factory("InputErrorsService",function(){return{shouldShowErrors:function(o,e){return o.$dirty&&o.$touched||e}}}),angular.module("app").factory("ResourceService",["$resource",function(o){return o("http://localhost:3000/todos",{},{getTodos:{method:"GET",isArray:!0}})}]),angular.module("app").factory("TodosService",["$q","ResourceService",TodosService]),angular.module("app").config(["$stateProvider",function(o){o.state("editTodo",{url:"/edit-todo/:id",templateUrl:"./pages/editTodo/templates/editTodo.html",controller:"EditTodoCtrl",resolve:{todo:function(e,o){return o.getTodos().then(function(o){return o.find(function(o){return o._id===e.id})})}},onEnter:function(o,e){void 0===e&&o.go("home")}})}]),angular.module("app").config(["$stateProvider","$urlRouterProvider",function(o,e){o.state("home",{url:"/home",templateUrl:"./pages/home/templates/home.html",controller:"HomeCtrl",resolve:{todos:function(o){return o.getTodos()}}}),e.otherwise("/home")}]),angular.module("app").config(["$stateProvider",function(o){o.state("addTodo",{url:"/add-todo",templateUrl:"./pages/addTodo/templates/addTodo.html",controller:"AddTodoCtrl"})}]),angular.module("app").controller("EditTodoCtrl",["$scope","$state","TodosService","InputErrorsService","todo",EditTodoCtrl]),angular.module("app").controller("HomeCtrl",["$scope","todos",function(o,e){o.todos=e}]),angular.module("app").filter("capitalize",function(){return function(o){return o.charAt(0).toUpperCase()+o.slice(1)}}),angular.module("app").filter("dateToPastDaysFilter",function(){return function(o){var e=Date.now()-new Date(o),t=Math.floor(e/864e5);return 0<t?t:.5}}),angular.module("app").filter("todosFilter",["$filter","TodosToolboxService",todosFilter]),angular.module("app").factory("TodosToolboxService",TodosToolboxService),angular.module("app").controller("AddTodoCtrl",["$scope","$state","TodosService","InputErrorsService",AddTodoCtrl]),angular.module("app").directive("todo",[function(){return{restrict:"E",scope:{todo:"="},templateUrl:"./pages/home/directives/todo/todo.html",controller:"TodoCtrl"}}]),angular.module("app").controller("TodoCtrl",["$scope","TodosService",function(o,e){o.removeTodo=function(o){return e.removeTodo(o)}}]),angular.module("app").directive("todosToolbox",function(){return{restrict:"E",templateUrl:"./pages/home/directives/todosToolbox/todosToolbox.html",controller:"TodosToolboxCtrl"}}),angular.module("app").controller("TodosToolboxCtrl",["$scope","TodosToolboxService",function(o,e){o.filterValue=e.getFilterValue(),o.categoryFilter=e.getCategoryFilter(),o.doneFilter=e.getDoneFilter(),o.updateFilterValue=function(){return e.setFilterValue(o.filterValue)},o.updateCategoryFilter=function(){return e.setCategoryFilter(o.categoryFilter)},o.updateDoneFilter=function(){return e.setDoneFilter(o.doneFilter)}}]),angular.module("app").directive("todoList",[function(){return{restrict:"E",scope:{todos:"="},templateUrl:"./pages/home/directives/todoList/todoList.html"}}]);